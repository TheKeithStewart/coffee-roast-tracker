<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User-Friendly Onboarding - Coffee Roast Tracker</title>
    <style>
        /* User-friendly onboarding CSS variables */
        :root {
            --color-primary: #2563eb;
            --color-primary-hover: #1d4ed8;
            --color-primary-light: #dbeafe;
            --color-success: #059669;
            --color-success-light: #d1fae5;
            --color-warning: #d97706;
            --color-danger: #dc2626;
            --color-text-primary: #111827;
            --color-text-secondary: #6b7280;
            --color-background: #ffffff;
            --color-surface: #f9fafb;
            --color-border: #e5e7eb;
            
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
            --spacing-xl: 32px;
            --spacing-2xl: 48px;
            --spacing-3xl: 64px;
            
            --touch-target-sm: 44px;
            --touch-target-md: 60px;
            --touch-target-lg: 80px;
            
            --text-xs: 0.75rem;
            --text-sm: 0.875rem;
            --text-base: 1rem;
            --text-lg: 1.125rem;
            --text-xl: 1.25rem;
            --text-2xl: 1.5rem;
            --text-3xl: 1.875rem;
            --text-4xl: 2.25rem;
            --text-5xl: 3rem;
            
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --border-radius-xl: 16px;
            
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        @media (prefers-contrast: high) {
            :root {
                --color-text-primary: #000000;
                --color-background: #ffffff;
                --color-primary: #0000ff;
                --color-border: #000000;
                --color-surface: #f0f0f0;
            }
        }
        
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            font-size: var(--text-base);
            line-height: 1.6;
            color: var(--color-text-primary);
            background-color: var(--color-background);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }
        
        .onboarding-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        
        /* Skip link for accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--color-primary);
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: var(--border-radius);
            font-size: var(--text-sm);
            z-index: 1000;
        }
        
        .skip-link:focus {
            top: 6px;
        }
        
        /* Main content container */
        .onboarding-main {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-lg);
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
        }
        
        /* Step container */
        .step-container {
            background-color: var(--color-background);
            border-radius: var(--border-radius-xl);
            padding: var(--spacing-3xl) var(--spacing-2xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--color-border);
            text-align: center;
            width: 100%;
            max-width: 500px;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Progress indicator */
        .progress-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: var(--spacing-3xl);
            gap: var(--spacing-md);
        }
        
        .progress-bar {
            flex: 1;
            height: 6px;
            background-color: var(--color-border);
            border-radius: 3px;
            overflow: hidden;
            max-width: 200px;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--color-primary);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            font-size: var(--text-sm);
            color: var(--color-text-secondary);
            font-weight: 600;
            white-space: nowrap;
        }
        
        /* Step content */
        .step-icon {
            font-size: var(--text-5xl);
            margin-bottom: var(--spacing-xl);
            display: block;
            line-height: 1;
        }
        
        .step-title {
            font-size: var(--text-3xl);
            font-weight: 700;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-lg);
            line-height: 1.2;
        }
        
        .step-description {
            font-size: var(--text-lg);
            color: var(--color-text-secondary);
            margin-bottom: var(--spacing-3xl);
            line-height: 1.6;
        }
        
        /* User guidance messaging */
        .user-note {
            background-color: var(--color-primary-light);
            border: 2px solid var(--color-primary);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
            text-align: left;
        }
        
        .user-note-icon {
            font-size: var(--text-xl);
            margin-right: var(--spacing-sm);
        }
        
        .user-note-title {
            font-size: var(--text-base);
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: var(--spacing-sm);
            display: flex;
            align-items: center;
        }
        
        .user-note-text {
            font-size: var(--text-sm);
            color: var(--color-text-primary);
            line-height: 1.5;
        }
        
        /* Action buttons */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
            margin-top: var(--spacing-xl);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-lg) var(--spacing-xl);
            min-height: var(--touch-target-md);
            border: 2px solid transparent;
            border-radius: var(--border-radius-lg);
            font-size: var(--text-lg);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.15s ease;
            position: relative;
            outline: none;
            user-select: none;
        }
        
        .btn:focus {
            outline: 3px solid var(--color-primary);
            outline-offset: 2px;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-primary {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }
        
        .btn-primary:hover:not(:disabled) {
            background-color: var(--color-primary-hover);
            border-color: var(--color-primary-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }
        
        .btn-secondary {
            background-color: transparent;
            color: var(--color-text-secondary);
            border-color: var(--color-border);
        }
        
        .btn-secondary:hover:not(:disabled) {
            background-color: var(--color-surface);
            color: var(--color-text-primary);
            border-color: var(--color-text-secondary);
        }
        
        .btn-large {
            min-height: var(--touch-target-lg);
            padding: var(--spacing-xl) var(--spacing-2xl);
            font-size: var(--text-xl);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }
        
        /* Preference selection grids */
        .preference-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            text-align: left;
        }
        
        .preference-item {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-md);
            padding: var(--spacing-lg);
            background-color: var(--color-surface);
            border: 2px solid var(--color-border);
            border-radius: var(--border-radius-lg);
            cursor: pointer;
            transition: all 0.15s ease;
            position: relative;
        }
        
        .preference-item:hover {
            border-color: var(--color-primary);
            background-color: var(--color-background);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .preference-item:focus {
            outline: 3px solid var(--color-primary);
            outline-offset: 2px;
        }
        
        .preference-item.selected {
            border-color: var(--color-primary);
            background-color: var(--color-primary-light);
            box-shadow: var(--shadow-md);
        }
        
        .preference-item.selected::after {
            content: '‚úì';
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            width: 28px;
            height: 28px;
            background-color: var(--color-success);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: var(--text-sm);
        }
        
        .preference-icon {
            font-size: var(--text-2xl);
            line-height: 1;
            flex-shrink: 0;
            margin-top: var(--spacing-xs);
        }
        
        .preference-content {
            flex: 1;
        }
        
        .preference-title {
            font-size: var(--text-lg);
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-xs);
        }
        
        .preference-description {
            font-size: var(--text-sm);
            color: var(--color-text-secondary);
            line-height: 1.5;
        }
        
        .preference-benefits {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-xs);
            margin-top: var(--spacing-sm);
        }
        
        .benefit-tag {
            font-size: var(--text-xs);
            background-color: var(--color-success-light);
            color: var(--color-success);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: 12px;
            font-weight: 500;
        }
        
        /* Multi-select preferences */
        .preference-grid.multi-select .preference-item {
            cursor: pointer;
        }
        
        .preference-grid.multi-select .preference-item input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }
        
        /* Tutorial highlights */
        .tutorial-highlight {
            background-color: var(--color-warning);
            color: white;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius);
            font-size: var(--text-sm);
            font-weight: 600;
            display: inline-block;
            margin: 0 var(--spacing-xs);
        }
        
        /* Success celebration */
        .celebration-animation {
            font-size: var(--text-4xl);
            margin: var(--spacing-lg) 0;
            animation: celebrate 1s ease-in-out;
        }
        
        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2) rotate(5deg); }
        }
        
        /* Responsive design */
        @media (max-width: 480px) {
            .onboarding-main {
                padding: var(--spacing-md);
            }
            
            .step-container {
                padding: var(--spacing-2xl) var(--spacing-lg);
            }
            
            .step-title {
                font-size: var(--text-2xl);
            }
            
            .step-description {
                font-size: var(--text-base);
            }
            
            .action-buttons {
                margin-top: var(--spacing-2xl);
            }
        }
        
        @media (min-width: 768px) {
            .preference-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }
            
            .action-buttons {
                flex-direction: row;
                justify-content: center;
            }
            
            .btn {
                min-width: 160px;
            }
        }
        
        /* Accessibility helpers */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Loading state */
        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--color-border);
            border-top: 3px solid var(--color-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--spacing-md);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <div class="onboarding-container" id="onboardingApp">
        <main class="onboarding-main" id="main-content">
            <div class="step-container" id="stepContainer">
                <!-- Step content will be dynamically generated -->
            </div>
        </main>
    </div>

    <!-- Screen reader announcements -->
    <div id="announcements" aria-live="polite" aria-atomic="true" class="sr-only"></div>

    <script>
        /**
         * User-Friendly Onboarding Flow
         * 
         * Features:
         * - Progressive disclosure with clear step-by-step guidance
         * - User-focused explanations and benefits
         * - Preference setup for optimal user experience
         * - Skippable sections with smart defaults
         * - Clear progress indication and celebration
         */
        
        class UserFriendlyOnboardingFlow {
            constructor() {
                this.state = {
                    currentStep: 0,
                    totalSteps: 6,
                    preferences: {
                        complexityMode: 'standard',
                        focusOptimizations: [],
                        accessibilityFeatures: [],
                        notifications: true,
                        tutorial: true
                    },
                    isComplete: false
                };
                
                this.steps = [
                    {
                        id: 'welcome',
                        title: 'Welcome to Coffee Roast Tracker!',
                        icon: '‚òï',
                        render: this.renderWelcomeStep.bind(this)
                    },
                    {
                        id: 'features-intro',
                        title: 'Designed for Better Focus',
                        icon: 'üß†',
                        render: this.renderFeaturesIntroStep.bind(this)
                    },
                    {
                        id: 'complexity-mode',
                        title: 'Choose Your Complexity Level',
                        icon: 'üéõÔ∏è',
                        render: this.renderComplexityStep.bind(this)
                    },
                    {
                        id: 'focus-features',
                        title: 'Focus Enhancement Features',
                        icon: 'üéØ',
                        render: this.renderFocusFeaturesStep.bind(this)
                    },
                    {
                        id: 'accessibility',
                        title: 'Accessibility Preferences',
                        icon: '‚ôø',
                        render: this.renderAccessibilityStep.bind(this)
                    },
                    {
                        id: 'complete',
                        title: 'Ready to Start Roasting!',
                        icon: 'üéâ',
                        render: this.renderCompleteStep.bind(this)
                    }
                ];
                
                this.initializeElements();
                this.bindEventListeners();
                this.renderCurrentStep();
                this.announceInitialState();
            }
            
            initializeElements() {
                this.elements = {
                    stepContainer: document.getElementById('stepContainer'),
                    announcements: document.getElementById('announcements')
                };
            }
            
            bindEventListeners() {
                // Keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && e.target.classList.contains('preference-item')) {
                        this.togglePreference(e.target);
                    }
                    
                    // Skip to end shortcut for testing
                    if (e.key === 'Escape' && e.ctrlKey) {
                        this.skipToEnd();
                    }
                });
            }
            
            renderCurrentStep() {
                const step = this.steps[this.state.currentStep];
                if (step) {
                    this.elements.stepContainer.innerHTML = step.render();
                    this.updateProgress();
                    
                    // Focus first interactive element
                    setTimeout(() => {
                        const firstFocusable = this.elements.stepContainer.querySelector(
                            'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                        );
                        if (firstFocusable) {
                            firstFocusable.focus();
                        }
                    }, 100);
                }
            }
            
            updateProgress() {
                const progressFill = document.querySelector('.progress-fill');
                const progressText = document.querySelector('.progress-text');
                
                if (progressFill && progressText) {
                    const progress = ((this.state.currentStep + 1) / this.state.totalSteps) * 100;
                    progressFill.style.width = `${progress}%`;
                    progressText.textContent = `Step ${this.state.currentStep + 1} of ${this.state.totalSteps}`;
                }
            }
            
            renderWelcomeStep() {
                return `
                    <div class="progress-header">
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                        <div class="progress-text"></div>
                    </div>
                    
                    <span class="step-icon" aria-hidden="true">‚òï</span>
                    <h1 class="step-title">Welcome to Coffee Roast Tracker!</h1>
                    <p class="step-description">
                        We're excited to help you on your coffee roasting journey. This app is designed 
                        with user-friendly features to make roasting more enjoyable and accessible for everyone.
                    </p>
                    
                    <div class="user-note">
                        <div class="user-note-title">
                            <span class="user-note-icon" aria-hidden="true">üí°</span>
                            Why focus on usability?
                        </div>
                        <div class="user-note-text">
                            Coffee roasting requires focus and timing. We've built features to simplify the interface, 
                            minimize distractions, and provide clear guidance during your roasting sessions.
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-large" onclick="onboardingApp.nextStep()">
                            Let's Get Started!
                        </button>
                        <button class="btn btn-secondary" onclick="onboardingApp.skipOnboarding()">
                            Skip Setup (Use Defaults)
                        </button>
                    </div>
                `;
            }
            
            renderFeaturesIntroStep() {
                return `
                    <div class="progress-header">
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                        <div class="progress-text"></div>
                    </div>
                    
                    <span class="step-icon" aria-hidden="true">üß†</span>
                    <h1 class="step-title">Designed for Better Focus</h1>
                    <p class="step-description">
                        Our interface includes research-backed design patterns that work better for focused work:
                    </p>
                    
                    <div class="preference-grid">
                        <div class="preference-item">
                            <span class="preference-icon" aria-hidden="true">üéØ</span>
                            <div class="preference-content">
                                <div class="preference-title">Focus Management</div>
                                <div class="preference-description">
                                    Limit distractions during time-sensitive roasting phases with focus mode
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Simplified interface</span>
                                    <span class="benefit-tag">Better concentration</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="preference-item">
                            <span class="preference-icon" aria-hidden="true">üîÑ</span>
                            <div class="preference-content">
                                <div class="preference-title">Progressive Complexity</div>
                                <div class="preference-description">
                                    Start simple and add features as you become more comfortable
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Gradual learning</span>
                                    <span class="benefit-tag">Simplified interface</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="preference-item">
                            <span class="preference-icon" aria-hidden="true">üíæ</span>
                            <div class="preference-content">
                                <div class="preference-title">Auto-Save Everything</div>
                                <div class="preference-description">
                                    Never lose progress with automatic saving every 30 seconds
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">No data loss</span>
                                    <span class="benefit-tag">Peace of mind</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="preference-item">
                            <span class="preference-icon" aria-hidden="true">üëÜ</span>
                            <div class="preference-content">
                                <div class="preference-title">Easy-to-Use Controls</div>
                                <div class="preference-description">
                                    Large, responsive buttons for easier interaction, especially during roasting
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Easier interaction</span>
                                    <span class="benefit-tag">Fewer mistakes</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-large" onclick="onboardingApp.nextStep()">
                            Sounds Great!
                        </button>
                        <button class="btn btn-secondary" onclick="onboardingApp.previousStep()">
                            Back
                        </button>
                    </div>
                `;
            }
            
            renderComplexityStep() {
                return `
                    <div class="progress-header">
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                        <div class="progress-text"></div>
                    </div>
                    
                    <span class="step-icon" aria-hidden="true">üéõÔ∏è</span>
                    <h1 class="step-title">Choose Your Complexity Level</h1>
                    <p class="step-description">
                        Select how much information and how many features you want to see initially. 
                        You can always change this later in settings.
                    </p>
                    
                    <div class="preference-grid single-select" id="complexityGrid">
                        <div class="preference-item ${this.state.preferences.complexityMode === 'simple' ? 'selected' : ''}" 
                             tabindex="0" role="radio" aria-checked="${this.state.preferences.complexityMode === 'simple'}"
                             data-value="simple" onclick="onboardingApp.selectComplexity('simple')">
                            <span class="preference-icon" aria-hidden="true">üü¢</span>
                            <div class="preference-content">
                                <div class="preference-title">Simple Mode</div>
                                <div class="preference-description">
                                    Essential features only. Perfect for beginners or when you want minimal distractions.
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Minimal interface</span>
                                    <span class="benefit-tag">Recent beans only</span>
                                    <span class="benefit-tag">Basic timer</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="preference-item ${this.state.preferences.complexityMode === 'standard' ? 'selected' : ''}" 
                             tabindex="0" role="radio" aria-checked="${this.state.preferences.complexityMode === 'standard'}"
                             data-value="standard" onclick="onboardingApp.selectComplexity('standard')">
                            <span class="preference-icon" aria-hidden="true">üü°</span>
                            <div class="preference-content">
                                <div class="preference-title">Standard Mode (Recommended)</div>
                                <div class="preference-description">
                                    Balanced feature set with phase tracking, temperature monitoring, and basic notes.
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Phase tracking</span>
                                    <span class="benefit-tag">Temperature monitoring</span>
                                    <span class="benefit-tag">Roast profiles</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="preference-item ${this.state.preferences.complexityMode === 'advanced' ? 'selected' : ''}" 
                             tabindex="0" role="radio" aria-checked="${this.state.preferences.complexityMode === 'advanced'}"
                             data-value="advanced" onclick="onboardingApp.selectComplexity('advanced')">
                            <span class="preference-icon" aria-hidden="true">üî¥</span>
                            <div class="preference-content">
                                <div class="preference-title">Advanced Mode</div>
                                <div class="preference-description">
                                    Full feature set including custom curves, detailed analytics, and comparison tools.
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Custom curves</span>
                                    <span class="benefit-tag">Advanced analytics</span>
                                    <span class="benefit-tag">Export/import</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-large" onclick="onboardingApp.nextStep()">
                            Continue
                        </button>
                        <button class="btn btn-secondary" onclick="onboardingApp.previousStep()">
                            Back
                        </button>
                    </div>
                `;
            }
            
            renderFocusFeaturesStep() {
                return `
                    <div class="progress-header">
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                        <div class="progress-text"></div>
                    </div>
                    
                    <span class="step-icon" aria-hidden="true">üéØ</span>
                    <h1 class="step-title">Focus Enhancement Features</h1>
                    <p class="step-description">
                        Select which focus-friendly features you'd like to enable. These are designed to 
                        simplify the interface and provide clear guidance.
                    </p>
                    
                    <div class="preference-grid multi-select" id="focusFeaturesGrid">
                        <div class="preference-item ${this.state.preferences.focusOptimizations.includes('focusMode') ? 'selected' : ''}" 
                             tabindex="0" data-value="focusMode" onclick="onboardingApp.toggleFocusFeature('focusMode')">
                            <span class="preference-icon" aria-hidden="true">üîí</span>
                            <div class="preference-content">
                                <div class="preference-title">Focus Mode During Roasting</div>
                                <div class="preference-description">
                                    Limit navigation options and hide non-essential information during active roasting
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Reduced distractions</span>
                                    <span class="benefit-tag">Better focus</span>
                                </div>
                            </div>
                            <input type="checkbox" ${this.state.preferences.focusOptimizations.includes('focusMode') ? 'checked' : ''} 
                                   aria-label="Focus mode during roasting">
                        </div>
                        
                        <div class="preference-item ${this.state.preferences.focusOptimizations.includes('autoSave') ? 'selected' : ''}" 
                             tabindex="0" data-value="autoSave" onclick="onboardingApp.toggleFocusFeature('autoSave')">
                            <span class="preference-icon" aria-hidden="true">üíæ</span>
                            <div class="preference-content">
                                <div class="preference-title">Frequent Auto-Save (30 seconds)</div>
                                <div class="preference-description">
                                    Automatically save your progress every 30 seconds to prevent data loss
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">No data loss</span>
                                    <span class="benefit-tag">Peace of mind</span>
                                </div>
                            </div>
                            <input type="checkbox" ${this.state.preferences.focusOptimizations.includes('autoSave') ? 'checked' : ''} 
                                   aria-label="Frequent auto-save">
                        </div>
                        
                        <div class="preference-item ${this.state.preferences.focusOptimizations.includes('defaultSelections') ? 'selected' : ''}" 
                             tabindex="0" data-value="defaultSelections" onclick="onboardingApp.toggleFocusFeature('defaultSelections')">
                            <span class="preference-icon" aria-hidden="true">‚ö°</span>
                            <div class="preference-content">
                                <div class="preference-title">Smart Default Selections</div>
                                <div class="preference-description">
                                    Pre-select common options based on your roasting history and patterns
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Faster setup</span>
                                    <span class="benefit-tag">Fewer decisions</span>
                                </div>
                            </div>
                            <input type="checkbox" ${this.state.preferences.focusOptimizations.includes('defaultSelections') ? 'checked' : ''} 
                                   aria-label="Smart default selections">
                        </div>
                        
                        <div class="preference-item ${this.state.preferences.focusOptimizations.includes('visualConfirmation') ? 'selected' : ''}" 
                             tabindex="0" data-value="visualConfirmation" onclick="onboardingApp.toggleFocusFeature('visualConfirmation')">
                            <span class="preference-icon" aria-hidden="true">‚úÖ</span>
                            <div class="preference-content">
                                <div class="preference-title">Visual Action Confirmation</div>
                                <div class="preference-description">
                                    Clear visual feedback for all button presses and state changes
                                </div>
                                <div class="preference-benefits">
                                    <span class="benefit-tag">Clear feedback</span>
                                    <span class="benefit-tag">Confidence in actions</span>
                                </div>
                            </div>
                            <input type="checkbox" ${this.state.preferences.focusOptimizations.includes('visualConfirmation') ? 'checked' : ''} 
                                   aria-label="Visual action confirmation">
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-large" onclick="onboardingApp.nextStep()">
                            Continue
                        </button>
                        <button class="btn btn-secondary" onclick="onboardingApp.previousStep()">
                            Back
                        </button>
                    </div>
                `;
            }
            
            renderAccessibilityStep() {
                return `
                    <div class="progress-header">
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                        <div class="progress-text"></div>
                    </div>
                    
                    <span class="step-icon" aria-hidden="true">‚ôø</span>
                    <h1 class="step-title">Accessibility Preferences</h1>
                    <p class="step-description">
                        Configure accessibility features to make the app work better for your specific needs.
                    </p>
                    
                    <div class="preference-grid multi-select" id="accessibilityGrid">
                        <div class="preference-item ${this.state.preferences.accessibilityFeatures.includes('highContrast') ? 'selected' : ''}" 
                             tabindex="0" data-value="highContrast" onclick="onboardingApp.toggleAccessibilityFeature('highContrast')">
                            <span class="preference-icon" aria-hidden="true">üåì</span>
                            <div class="preference-content">
                                <div class="preference-title">High Contrast Mode</div>
                                <div class="preference-description">
                                    Increase color contrast for better visibility and reduced eye strain
                                </div>
                            </div>
                            <input type="checkbox" ${this.state.preferences.accessibilityFeatures.includes('highContrast') ? 'checked' : ''} 
                                   aria-label="High contrast mode">
                        </div>
                        
                        <div class="preference-item ${this.state.preferences.accessibilityFeatures.includes('reduceMotion') ? 'selected' : ''}" 
                             tabindex="0" data-value="reduceMotion" onclick="onboardingApp.toggleAccessibilityFeature('reduceMotion')">
                            <span class="preference-icon" aria-hidden="true">üêå</span>
                            <div class="preference-content">
                                <div class="preference-title">Reduce Motion</div>
                                <div class="preference-description">
                                    Minimize animations and transitions to reduce vestibular sensitivity
                                </div>
                            </div>
                            <input type="checkbox" ${this.state.preferences.accessibilityFeatures.includes('reduceMotion') ? 'checked' : ''} 
                                   aria-label="Reduce motion">
                        </div>
                        
                        <div class="preference-item ${this.state.preferences.accessibilityFeatures.includes('largeTouchTargets') ? 'selected' : ''}" 
                             tabindex="0" data-value="largeTouchTargets" onclick="onboardingApp.toggleAccessibilityFeature('largeTouchTargets')">
                            <span class="preference-icon" aria-hidden="true">üëÜ</span>
                            <div class="preference-content">
                                <div class="preference-title">Extra Large Touch Targets</div>
                                <div class="preference-description">
                                    Increase button and touch target sizes to 80px+ for easier interaction
                                </div>
                            </div>
                            <input type="checkbox" ${this.state.preferences.accessibilityFeatures.includes('largeTouchTargets') ? 'checked' : ''} 
                                   aria-label="Extra large touch targets">
                        </div>
                        
                        <div class="preference-item ${this.state.preferences.accessibilityFeatures.includes('screenReaderOptimized') ? 'selected' : ''}" 
                             tabindex="0" data-value="screenReaderOptimized" onclick="onboardingApp.toggleAccessibilityFeature('screenReaderOptimized')">
                            <span class="preference-icon" aria-hidden="true">üîä</span>
                            <div class="preference-content">
                                <div class="preference-title">Screen Reader Optimization</div>
                                <div class="preference-description">
                                    Enhanced ARIA labels and live region announcements for screen readers
                                </div>
                            </div>
                            <input type="checkbox" ${this.state.preferences.accessibilityFeatures.includes('screenReaderOptimized') ? 'checked' : ''} 
                                   aria-label="Screen reader optimization">
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-large" onclick="onboardingApp.nextStep()">
                            Almost Done!
                        </button>
                        <button class="btn btn-secondary" onclick="onboardingApp.previousStep()">
                            Back
                        </button>
                    </div>
                `;
            }
            
            renderCompleteStep() {
                return `
                    <div class="progress-header">
                        <div class="progress-bar">
                            <div class="progress-fill"></div>
                        </div>
                        <div class="progress-text"></div>
                    </div>
                    
                    <div class="celebration-animation" aria-hidden="true">üéâ</div>
                    <h1 class="step-title">You're All Set!</h1>
                    <p class="step-description">
                        Your user-friendly Coffee Roast Tracker is ready to go. Here's what we've set up for you:
                    </p>
                    
                    <div class="preference-grid">
                        <div class="preference-item">
                            <span class="preference-icon" aria-hidden="true">üéõÔ∏è</span>
                            <div class="preference-content">
                                <div class="preference-title">Complexity Level</div>
                                <div class="preference-description">
                                    ${this.getComplexityDescription()}
                                </div>
                            </div>
                        </div>
                        
                        <div class="preference-item">
                            <span class="preference-icon" aria-hidden="true">üéØ</span>
                            <div class="preference-content">
                                <div class="preference-title">Focus Features</div>
                                <div class="preference-description">
                                    ${this.state.preferences.focusOptimizations.length} features enabled
                                </div>
                            </div>
                        </div>
                        
                        <div class="preference-item">
                            <span class="preference-icon" aria-hidden="true">‚ôø</span>
                            <div class="preference-content">
                                <div class="preference-title">Accessibility</div>
                                <div class="preference-description">
                                    ${this.state.preferences.accessibilityFeatures.length} features enabled
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="adhd-note">
                        <div class="adhd-note-title">
                            <span class="adhd-note-icon" aria-hidden="true">üí°</span>
                            Remember: You can change these settings anytime
                        </div>
                        <div class="adhd-note-text">
                            Access settings from the ‚öôÔ∏è icon in the navigation bar. Your preferences are automatically 
                            saved and will be remembered across devices.
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-large" onclick="onboardingApp.completeOnboarding()">
                            Start My First Roast!
                        </button>
                        <button class="btn btn-secondary" onclick="onboardingApp.goToDashboard()">
                            Go to Dashboard
                        </button>
                    </div>
                `;
            }
            
            getComplexityDescription() {
                const descriptions = {
                    simple: 'Simple mode - Essential features only',
                    standard: 'Standard mode - Balanced feature set',
                    advanced: 'Advanced mode - Full feature access'
                };
                return descriptions[this.state.preferences.complexityMode] || 'Standard mode';
            }
            
            // Navigation methods
            nextStep() {
                if (this.state.currentStep < this.state.totalSteps - 1) {
                    this.state.currentStep++;
                    this.renderCurrentStep();
                    this.announce(`Advanced to step ${this.state.currentStep + 1} of ${this.state.totalSteps}`);
                }
            }
            
            previousStep() {
                if (this.state.currentStep > 0) {
                    this.state.currentStep--;
                    this.renderCurrentStep();
                    this.announce(`Returned to step ${this.state.currentStep + 1} of ${this.state.totalSteps}`);
                }
            }
            
            // Preference selection methods
            selectComplexity(mode) {
                this.state.preferences.complexityMode = mode;
                
                // Update UI
                document.querySelectorAll('#complexityGrid .preference-item').forEach(item => {
                    const isSelected = item.dataset.value === mode;
                    item.classList.toggle('selected', isSelected);
                    item.setAttribute('aria-checked', isSelected.toString());
                });
                
                this.announce(`Selected ${mode} complexity mode`);
            }
            
            toggleFocusFeature(feature) {
                const features = this.state.preferences.focusOptimizations;
                const index = features.indexOf(feature);
                
                if (index > -1) {
                    features.splice(index, 1);
                    this.announce(`Disabled ${feature}`);
                } else {
                    features.push(feature);
                    this.announce(`Enabled ${feature}`);
                }
                
                // Update UI
                const item = document.querySelector(`[data-value="${feature}"]`);
                if (item) {
                    const isSelected = features.includes(feature);
                    item.classList.toggle('selected', isSelected);
                    const checkbox = item.querySelector('input[type="checkbox"]');
                    if (checkbox) {
                        checkbox.checked = isSelected;
                    }
                }
            }
            
            toggleAccessibilityFeature(feature) {
                const features = this.state.preferences.accessibilityFeatures;
                const index = features.indexOf(feature);
                
                if (index > -1) {
                    features.splice(index, 1);
                    this.announce(`Disabled ${feature}`);
                } else {
                    features.push(feature);
                    this.announce(`Enabled ${feature}`);
                }
                
                // Update UI
                const item = document.querySelector(`[data-value="${feature}"]`);
                if (item) {
                    const isSelected = features.includes(feature);
                    item.classList.toggle('selected', isSelected);
                    const checkbox = item.querySelector('input[type="checkbox"]');
                    if (checkbox) {
                        checkbox.checked = isSelected;
                    }
                }
            }
            
            // Completion methods
            skipOnboarding() {
                if (confirm('Are you sure you want to skip setup? We recommend taking a few minutes to configure the app for your needs.')) {
                    this.setDefaults();
                    this.completeOnboarding();
                }
            }
            
            skipToEnd() {
                this.state.currentStep = this.state.totalSteps - 1;
                this.renderCurrentStep();
                this.announce('Skipped to completion step');
            }
            
            setDefaults() {
                // Set sensible user-friendly defaults
                this.state.preferences = {
                    complexityMode: 'standard',
                    focusOptimizations: ['focusMode', 'autoSave', 'visualConfirmation'],
                    accessibilityFeatures: ['largeTouchTargets'],
                    notifications: true,
                    tutorial: true
                };
            }
            
            completeOnboarding() {
                this.state.isComplete = true;
                this.savePreferences();
                this.announce('Onboarding completed successfully. Welcome to Coffee Roast Tracker!');
                
                // Simulate transition to main app
                setTimeout(() => {
                    alert('üéâ Onboarding complete! You would now be taken to the roasting interface or dashboard.');
                }, 1000);
            }
            
            goToDashboard() {
                this.state.isComplete = true;
                this.savePreferences();
                this.announce('Going to dashboard. Onboarding completed successfully.');
                
                // Simulate transition to dashboard
                setTimeout(() => {
                    alert('üìä Taking you to the dashboard where you can explore your roasting data and start new roasts.');
                }, 1000);
            }
            
            savePreferences() {
                try {
                    localStorage.setItem('coffee-tracker-onboarding', JSON.stringify({
                        completed: true,
                        preferences: this.state.preferences,
                        completedAt: new Date().toISOString()
                    }));
                    console.log('Onboarding preferences saved:', this.state.preferences);
                } catch (e) {
                    console.warn('Failed to save onboarding preferences:', e);
                }
            }
            
            announce(message) {
                this.elements.announcements.textContent = '';
                setTimeout(() => {
                    this.elements.announcements.textContent = message;
                }, 100);
                
                setTimeout(() => {
                    this.elements.announcements.textContent = '';
                }, 5000);
            }
            
            announceInitialState() {
                this.announce('User-friendly onboarding started. This setup process is designed to be quick and focused, with sensible defaults if you prefer to skip any steps.');
            }
        }
        
        // Initialize the onboarding flow when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Check if onboarding was already completed
            const saved = localStorage.getItem('coffee-tracker-onboarding');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    if (data.completed) {
                        alert('Onboarding already completed! This is a demo of the onboarding flow.');
                    }
                } catch (e) {
                    console.warn('Failed to parse saved onboarding data');
                }
            }
            
            // Initialize the onboarding app
            window.onboardingApp = new UserFriendlyOnboardingFlow();
            
            // Apply system preferences
            const preferReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            const preferHighContrast = window.matchMedia('(prefers-contrast: high)').matches;
            
            if (preferReducedMotion) {
                document.body.classList.add('reduce-motion');
            }
            
            if (preferHighContrast) {
                document.body.classList.add('high-contrast');
            }
        });
    </script>
</body>
</html>